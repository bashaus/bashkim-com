command-timeout: 30

build-node:
  box: 'node:8.10'
  steps:
    - npm-install:
        name: npm install
    - script:
        name: npm run build
        code: npm run build
    - script:
        name: npm run storybook-build
        code: npm run storybook-build

deploy:
  box: 'node:8.10'
  steps:
    - script:
        name: serverless install
        code: npm install -g serverless
    - script:
        name: serverless deploy
        code: serverless deploy

synchronise:
  box: 'python:3.6'
  steps:
    - bashaus/aws-s3-deploy:
        name: s3 website assets
        configuration-file: s3.website.yml
        target-bucket: $DEPLOY_S3_WEBSITE_BUCKET

    - bashaus/aws-s3-deploy:
        name: s3 styleguide
        configuration-file: s3.styleguide.yml
        target-bucket: $DEPLOY_S3_STYLEGUIDE_BUCKET
